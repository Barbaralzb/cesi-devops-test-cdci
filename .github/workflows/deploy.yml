name: Deploy
run-name: ${{ github.actor }} deploy
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        - name: Connect to VM and update repository
        - run : ssh -i ${{ secrets.KEY }} ${{ variables.ADMIN }}@${{ variables.ADMIN }}

      - name: Install dependencies and build
        - run : cd cesi-devops-test-cdci/
        - run : git pull
        - run: npm install
        - run: npm run build

      - name: Start the application
        - run: pm2 restart all

